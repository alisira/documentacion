<html><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<title>Capítulo&nbsp;1.&nbsp;Aplicación Base y Configuración del Entorno</title>
<link rel="stylesheet" href="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/html.css" type="text/css">
<link rel="home" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/index.html" title="Desarrollando una aplicación Spring Framework MVC v4 + JPA paso a paso">
<link rel="up" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/index.html" title="Desarrollando una aplicación Spring Framework MVC v4 + JPA paso a paso">
<link rel="previous" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/overview.html" title="Descripción">
<link rel="next" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/part2.html" title="Capítulo&nbsp;2.&nbsp;Desarrollando y Configurando la Vista y el Controlador">
</head>
<body link="#0000ff" text="black" vlink="#840084" alink="#0000ff" bgcolor="white">
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" style="border: 1px solid black; background-color: white; height: 73px;"><a style="border: medium none;" href="http://www.springframework.org/" title="The Spring Framework"><img style="border: medium none;" src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/xdev-spring_logo.jpg"></a><a style="border: medium none;" href="http://www.springsource.com/" title="SpringSource"><img style="border: medium none; position: absolute; padding-top: 5px; right: 42px;" src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/springsource-banner-rhs.png"></a></div>
<div class="chapter" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title"><a name="part1"></a>Capítulo&nbsp;1.&nbsp;Aplicación
Base y Configuración del Entorno</h2>
</div>
</div>
<div></div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.1"></a>1.1.&nbsp;Crear
la estructura de directorios del proyecto</h2>
</div>
</div>
<div></div>
</div>
<p>Necesitamos crear un directorio donde alojar todos los archivos que
vayamos creando, así que comenzaremos creando un proyecto en el Workspace llamado <tt class="filename">'springapp'</tt>.
 Utilizaremos Maven2 para facilitar la creación de la estructura de 
directorios del proyecto así como la inclusión de las librerías 
necesarias.</p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/project-creation.png" align="middle">
<div class="caption">
<p>Creación del nuevo proyecto usando Maven</p>
</div>
</div>
</div>
<p>
Tras seleccionar el proyecto de tipo Maven y pinchar <tt class="classname">'Next'</tt>
 para mantener la localización del proyecto dentro del Workspace, 
debemos seleccionar el arquetipo del proyecto. Los arquetipos son 
patrones o modelos genéricos a partir de los cuales se pueden crear 
proyectos de un determinado tipo. Maven proporciona un conjunto de 
estructuras de proyectos (esto es, el árbol de directorios, ficheros que
 aparecerán en el proyecto, etc.) entre los cuales podemos elegir. De 
acuerdo con la naturaleza del proyecto que se creará en este tutorial, 
debemos seleccionar el arquetipo <tt class="property">'maven-archetype-webapp'</tt>.</p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/project-archetype.png" align="middle">
<div class="caption">
<p>Selección del arquetipo del proyecto</p>
</div>
</div>
</div>
<p>
Maven, entre otras funcionalidades, es útil como herramienta para la 
gestión de dependencias entre proyectos y permite definir diferentes 
componentes (llamados artifacts) que forman parte de un grupo de trabajo
 con una entidad mayor. De momento, sólo disponemos de nuestra simple 
aplicación para la gestión de inventario. </p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/project-name.png" align="middle">
<div class="caption">
<p>Definición del nombre del proyecto</p>
</div>
</div>
</div>
<p>
Una vez que el proyecto se ha creado, podemos identificar la siguiente estructura:</p>

<div class="itemizedlist">
<ul type="disc">
	<li>
	<p>El subdirectorio <tt class="filename">'src/main/resources'</tt> que contendrá todos los recursos utilizados por la aplicación.</p>
	</li>
	<li>
	<p>El subdirectorio <tt class="filename">'src/main/webapp'</tt> que alojará todos los archivos que no sean código fuente Java, como archivos JSP y de configuración.</p>
	</li>
	<li>
	<p>El directorio <tt class="filename">'target'</tt> donde se generará el archivo WAR que usaremos para almacenar y desplegar rápidamente nuestra aplicación.</p>
	</li>
	<li>
	<p>El fichero <tt class="filename">'pom.xml'</tt> que contiene las dependencias Maven.</p>
	</li>
</ul>
</div>

<p>Si apareciera un warning en el proyecto causado por el uso de 
diferentes versiones de la JDK, ajustarlas conveniente configurando el <tt class="filename">Build Path</tt> del proyecto.</p>

<p>A continuación puedes ver una captura de pantalla que muestra como quedaría
la estructura de directorios si has seguido las instrucciones
correctamente. <span class="emphasis"><em>(La imagen muestra
dicha estructura desde el SpringSource Tool Suite (STS): no se necesita usar STS para
completar este tutorial, pero usándolo podrás hacerlo de manera mucho
más sencilla).</em></span></p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/project-structure.png" width="900" align="middle">
<div class="caption">
<p>La estructura de directorios del proyecto</p>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.2"></a>1.2.&nbsp;Crear
<tt class="filename">'index.jsp'</tt></h2>
</div>
</div>
<div></div>
</div>
<p>Puesto que estamos creando una aplicación web, Maven ya ha creado
un archivo JSP muy simple llamado <tt class="filename">'index.jsp'</tt>
en el directorio <tt class="filename">'src/main/webapp'</tt>. El archivo <tt class="filename">'index.jsp'</tt> es el punto de entrada a nuestra
aplicación. Para familiarizarnos con el entorno, podemos cambiarlo por el que se muestra a continuación: </p>


<p><tt class="filename">'springapp/src/main/webapp/index.jsp'</tt>:</p>
<pre class="programlisting">&lt;html&gt;
  &lt;head&gt;&lt;title&gt;Example :: Spring Application&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Example - Spring Application&lt;/h1&gt;
    &lt;p&gt;This is my test.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre>

<p>Asimismo, Maven también ha creado un archivo llamado <tt class="filename">'web.xml'</tt> dentro del directorio <tt class="filename">'src/main/webapp/WEB-INF'</tt>
 con la configuración básica para ejecutar la aplicación por primera 
vez. Proponemos modificarlo por el que se muestra a continuación para 
utilizar una especificación más moderna de JavaEE.</p>

<p><tt class="filename">'springapp/src/main/webapp/WEB-INF/web.xml'</tt>:</p>
<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/javaee"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:web="http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"
	xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/javaee/web-app_2_5.xsd"&gt;

  &lt;display-name&gt;Springapp&lt;/display-name&gt;

&lt;/web-app&gt;</pre></div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.3"></a>1.3.&nbsp;Desplegar
la aplicación en el servidor</h2>
</div>
</div>
<div></div>
</div>

<p>Para compilar, construir y desplegar la aplicación
automáticamente sólo es necesario seleccionar <tt class="classname">'Run as &gt; Run on Server'</tt>
 sobre el menú contextual que aparece cuando se pincha el botón derecho 
sobre el nombre del proyecto. A continuación, debemos seleccionar el 
servidor desde el cuadro de diálogo que ofrece los servidores dados de 
alta en el entorno. Por ejemplo: vFabric tc Server, Tomcat, GlassFish, 
etc.</p>



<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.4"></a>1.4.&nbsp;Comprobar
que la aplicación funciona</h2>
</div>
</div>
<div></div>
</div>
<p>Los pasos anteriores abrirán una pestaña en el entorno de desarrollo STS donde se puede ver el contenido de la página <tt class="filename">'index.jsp'</tt>. De manera alternativa, se puede abrir un navegador y acceder a la página de inicio de la aplicación en la siguiente URL: <a href="http://localhost:8080/springapp" target="_top">http://localhost:8080/springapp</a>.</p>

<p><em>(La imagen muestra la visualización sobre STS: el número de puerto puede variar dependiendo del servidor utilizado).</em></p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/screen1.png" align="middle">
<div class="caption">
<p>La página de inicio de la aplicación</p>
</div>
</div>
</div>

<p>Se recomienda detener el servidor para evitar la recarga automática mientras se sigue desarrollando el proyecto.</p>

</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.5"></a>1.5.&nbsp;Descargar
Spring Framework</h2>
</div>
</div>
<div></div>
</div>
<p>Utilizaremos Maven para gestionar las dependencias del proyecto con 
Spring Framework así como para descargar otras librerías adicionales 
necesarias. Se puede consultar el repositorio Sonatype (<a href="http://repository.sonatype.org/index.html">http://repository.sonatype.org/index.html</a>) para obtener los datos concretos de las dependencias que incluiremos en el fichero <tt class="filename">'pom.xml'</tt>. En este fichero, hemos introducido una propiedad llamada <tt class="property">'org.springframework.version'</tt> y le hemos dado el valor <tt class="property">'4.0.3.RELEASE'</tt>.
 Este valor corresponde con la última versión disponible de Spring 
Framework en el momento en el que ha escrito el tutorial. Para consultar
 las versiones disponibles, se puede hacer una búqueda en Sonatype de la
 dependencia (artifact) <tt class="property">'spring-core'</tt>. La 
introducción de propiedades con el valor de la versión de cada 
dependencia facilitará la actualización del proyecto a nuevas versiones.</p> 
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/pom-properties.png" align="middle">
<div class="caption">
<p>Propiedades del fichero <tt class="filename">'pom.xml'</tt></p>
</div>
</div>
</div>
<p>A continuación, crearemos las siguientes dependencias para el proyecto desde la pestaña <tt class="property">'Dependencies'</tt> del fichero <tt class="filename">'pom.xml'</tt>. Las librerías seran descargadas y añadidas automáticamente al proyecto en el momento en el que guardemos el fichero <tt class="filename">'pom.xml'</tt></p>
<table border="1">
  <thead bgcolor="lightGray">
    <tr>
      <th>Group Id</th>
      <th>Artifact Id</th>
      <th>Version</th>
      <th>Scope</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><tt class="literal">junit</tt></td>
      <td><tt class="literal">junit</tt></td>
      <td><tt class="literal">4.11</tt></td>
      <td><tt class="literal">Test</tt></td>
    </tr>
    <tr>
      <td><tt class="literal">org.springframework</tt></td>
      <td><tt class="literal">spring-core</tt></td>
      <td><tt class="literal">${org.springframework.version}</tt></td>
      <td></td>
    </tr>
    <tr>
      <td><tt class="literal">org.springframework</tt></td>
      <td><tt class="literal">spring-webmvc</tt></td>
      <td><tt class="literal">${org.springframework.version}</tt></td>
      <td></td>
    </tr>
    <tr>
      <td><tt class="literal">javax.servlet</tt></td>
      <td><tt class="literal">servlet-api</tt></td>
      <td><tt class="literal">2.5</tt></td>
      <td><tt class="literal">Provided</tt></td>
    </tr>
  </tbody>
</table>
<p>Nótese como la dependencia <tt class="property">'junit'</tt> (incluida por defecto en el fichero <tt class="filename">'pom.xml'</tt>) ha sido actualizada a la versión <tt class="property">'4.11'</tt>. Por otra parte, la dependencia <tt class="property">'servlet-api'</tt> ha sido marcada como <tt class="property">'Provided'</tt>, ya que será proporcionada por el servidor sobre el que se despliegue la aplicación.</p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/pom-dependencies.png" align="middle">
<div class="caption">
<p>Dependencias del fichero <tt class="filename">'pom.xml'</tt></p>
</div>
</div>
</div>
<p><span class="emphasis"><em>Según el reporte de Roberto Rodríguez, si 
se está usando WebLogic 11G, es necesario añadir la dependencia de 
'joda-time' para evitar un error del tipo 
'java.lang.ClassNotFoundException: org.joda.time.LocalDate'. Los 
detalles de esta dependencia se muestran a continuación.</em></span></p>
<table border="1">
  <thead bgcolor="lightGray">
    <tr>
      <th>Group Id</th>
      <th>Artifact Id</th>
      <th>Version</th>
      <th>Scope</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td><tt class="literal">joda-time</tt></td>
      <td><tt class="literal">joda-time</tt></td>
      <td><tt class="literal">1.6</tt></td>
      <td></td>
    </tr>
  </tbody>
</table>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.6"></a>1.6.&nbsp;Modificar
<tt class="filename">'web.xml'</tt> en el directorio <tt class="filename">'src/main/webapp/WEB-INF'</tt></h2>
</div>
</div>
<div></div>
</div>
<p>Sitúate en el directorio <tt class="filename">'src/main/webapp/WEB-INF'</tt>.
Modifica el archivo <tt class="filename">'web.xml'</tt> del que hemos hablado
anteriormente. Vamos a definir un <tt class="classname">DispatcherServlet</tt>
(también llamado <tt class="literal">'Controlador Frontal'</tt> (Crupi
et al)). Su misión será controlar hacia dónde serán enrutadas todas
nuestras solicitudes basándose en información que introduciremos
posteriormente. La definición del servlet tendrá como acompañante una
entrada <tt class="literal">&lt;servlet-mapping/&gt;</tt> que mapeará
las URL que queremos que apunten a nuestro servlet. Hemos decidido
permitir que cualquier URL con una extensión de tipo <tt class="literal">'.htm'</tt>
sea enrutada hacia el servlet <tt class="literal">'springapp'</tt> ( <tt class="classname">DispatcherServlet</tt>).</p>
<p><tt class="filename">'springapp/src/main/webapp/WEB-INF/web.xml'</tt>:</p>
<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;web-app version="2.5" xmlns="http://java.sun.com/xml/ns/j2ee"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xmlns:web="http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd"
	xsi:schemaLocation="http://java.sun.com/xml/ns/javaee http://java.sun.com/xml/ns/j2ee/web-app_2_5.xsd"&gt;

  &lt;display-name&gt;Springapp&lt;/display-name&gt;
<span class="bold"><b>
  &lt;servlet&gt;
    &lt;servlet-name&gt;springapp&lt;/servlet-name&gt;
    &lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;
    &lt;init-param&gt;
       &lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;
       &lt;param-value&gt;/WEB-INF/spring/app-config.xml&lt;/param-value&gt;
    &lt;/init-param&gt;
    &lt;load-on-startup&gt;1&lt;/load-on-startup&gt;
  &lt;/servlet&gt;

  &lt;servlet-mapping&gt;
    &lt;servlet-name&gt;springapp&lt;/servlet-name&gt;
    &lt;url-pattern&gt;*.htm&lt;/url-pattern&gt;
  &lt;/servlet-mapping&gt;
</b></span>
&lt;/web-app&gt;</pre></div>

<p>A continuación, creamos el subdirectorio <tt class="filename">'src/main/webapp/WEB-INF/spring'</tt> y dentro el archivo llamado <tt class="filename">'app-config.xml'</tt>. Este archivo contendrá las definiciones de beans (POJO's) usados por el <tt class="classname">DispatcherServlet</tt>. Es decir, este archivo es el <tt class="classname">WebApplicationContext</tt> donde situaremos todos los componentes. Por tanto, utilizaremos el asistente para la creación de ficheros de tipo <tt class="literal">'Spring Bean Configuration File'</tt>. <span class="emphasis"><em>(Si
 no se utiliza STS y no se dispone del plugin Spring IDE de Eclipse, 
basta crear un fichero xml como el que se mostrará a continuación).</em></span></p> 
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/app-context-creation.png" align="middle">
<div class="caption">
<p>Creación del fichero <tt class="filename">'app-config.xml'</tt></p>
</div>
</div>
</div>
<p>Tras haber introducido el nombre del fichero, es necesario introducir
 los namespaces que se utilizarán. Seleccionamos los namespaces <tt class="literal">'beans'</tt>, <tt class="literal">'context'</tt> y <tt class="literal">'mvc'</tt> en las versiones que corresponden con la versión <tt class="literal">'4.0'</tt> de Spring Framework.</p>
<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/app-context-creation1.png" align="middle">
<div class="caption">
<p>Selección de los namespaces del fichero <tt class="filename">'app-config.xml'</tt></p>
</div>
</div>
</div>
<p>Por último, activamos la detección automática de componentes a través del uso de anotaciones. El fichero <tt class="filename">'app-config.xml'</tt>, por tanto, deberá tener el siguiente aspecto.</p>

<p><tt class="filename">'springapp/src/main/webapp/WEB-INF/spring/app-config.xml'</tt>:</p>
<pre class="programlisting">&lt;?xml version="1.0" encoding="UTF-8"?&gt;

&lt;beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:context="http://www.springframework.org/schema/context"
       xmlns:mvc="http://www.springframework.org/schema/mvc"
       xsi:schemaLocation="http://www.springframework.org/schema/beans
       http://www.springframework.org/schema/beans/spring-beans.xsd
       http://www.springframework.org/schema/context
       http://www.springframework.org/schema/context/spring-context.xsd
       http://www.springframework.org/schema/mvc
       http://www.springframework.org/schema/mvc/spring-mvc.xsd"&gt;

       <i class="lineannotation"><span class="lineannotation">&lt;!-- Scans the classpath of this application for @Components to deploy as beans --&gt;</span></i>
       &lt;context:component-scan base-package="com.companyname.springapp.web" /&gt;

       <i class="lineannotation"><span class="lineannotation">&lt;!-- Configures the @Controller programming model --&gt;</span></i>
       &lt;mvc:annotation-driven/&gt;

&lt;/beans&gt;</pre></div>

<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.7"></a>1.7.&nbsp;Crear
el <tt class="interfacename">Controlador</tt></h2>
</div>
</div>
<div></div>
</div>

<p>Vamos a crear una clase anotada con la etiqueta <tt class="interfacename">@Controller</tt> (a la que llamaremos <tt class="classname">HelloController</tt>) y que
estará definida dentro del paquete <tt class="literal">'com.companyname.springapp.web'</tt>.
Primero, creamos el directorio <tt class="filename">'src/main/java'</tt> como un directorio de tipo <tt class="literal">'Source Folder'</tt> donde alojaremos todos los ficheros Java de nuestra aplicación. Dentro de este directorio, creamos el paquete <tt class="literal">'com.companyname.springapp.web'</tt>. A continuación, creamos el archivo <tt class="filename">'HelloController.java'</tt>
 y lo situamos en el recién creado paquete. El uso de anotaciones en 
este fichero requerirá aumentar el nivel de compatibilidad como mínimo a
 Java 1.5.</p>

<p><tt class="filename">'springapp/src/main/java/com/companyname/springapp/web/HelloController.java'</tt>:</p>
<pre class="programlisting">package com.companyname.springapp.web;

import java.io.IOException;
import javax.servlet.ServletException;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import org.apache.commons.logging.Log;
import org.apache.commons.logging.LogFactory;
import org.springframework.stereotype.Controller;
import org.springframework.web.bind.annotation.RequestMapping;
import org.springframework.web.servlet.ModelAndView;

@Controller
public class HelloController {

    protected final Log logger = LogFactory.getLog(getClass());

    @RequestMapping(value="/hello.htm")
    public ModelAndView handleRequest(HttpServletRequest request, HttpServletResponse response)
            throws ServletException, IOException {

        logger.info("Returning hello view");

        return new ModelAndView("hello.jsp");
    }
}</pre>
<p>Esta implementación del controlador, mediante la anotación <tt class="interfacename">@Controller</tt>, es muy básica. Más tarde la iremos expandiendo. En Spring Web MVC, los componentes <tt class="interfacename">@Controller</tt> <span class="emphasis"><em>manejan</em></span> las solicitudes y devuelven normalmente un objeto <tt class="classname">ModelAndView</tt>. En este caso, uno llamado <tt class="filename">'hello.jsp'</tt>,
 el cual hace referencia al nombre del archivo JSP que vamos a crear a 
continuación. El modelo que esta clase devuelve es resuelto a través del
 <tt class="interfacename">ViewResolver</tt>. Puesto que no hemos definido
explicítamente un <tt class="interfacename">ViewResolver</tt>, vamos a
obtener uno por defecto de Spring que simplemente redigirá a una
dirección URL que coincida con el nombre de la vista especificada. Más
tarde modificaremos este comportamiento. Además, hemos especificado un logger de manera
que podemos verificar que pasamos por el manejador en cada momento.
Usando STS, estos mensajes de log deben mostrarse en la pestaña <tt class="literal">'Console'</tt>.</p>

<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.8"></a>1.8.&nbsp;Escribir
un test para el <tt class="interfacename">Controlador</tt></h2>
</div>
</div>
<div></div>
</div>
<p>Los tests son una parte vital del desarrollo del software. El mejor
momento para escribir los tests es durante el desarrollo, no después, de
manera que aunque nuestro controlador no contiene lógica demasiado
compleja vamos a escribir un test para probarlo. Esto nos permitirá
hacer cambios en el futuro con total seguridad. Vamos a crear (si no existiera) un nuevo
directorio de tipo <tt class="literal">'Source Folder'</tt> llamado <tt class="filename">'src/test/java'</tt>. Aquí es donde alojaremos todos nuestros
tests, en una estructura de paquetes que será idéntica a la estructura
de paquetes que tenemos en <tt class="filename">'src/main/java'</tt>.</p>

<p>Creamos una clase de test llamada <tt class="filename">'HelloControllerTests'</tt> dentro del paquete <tt class="literal">'com.companyname.springapp.web'</tt>. Para ello seleccionamos el tipo <tt class="literal">'JUnit Test Case'</tt> del asistente de creació de ficheros.</p>
<p><tt class="filename">'springapp/src/test/java/com/companyname/springapp/web/HelloControllerTests.java'</tt>:</p>
<pre class="programlisting">package com.companyname.springapp.web;

import static org.junit.Assert.*;

import org.junit.Test;
import org.springframework.web.servlet.ModelAndView;


public class HelloControllerTests {

    @Test
    public void testHandleRequestView() throws Exception{		
        HelloController controller = new HelloController();
        ModelAndView modelAndView = controller.handleRequest(null, null);		
        assertEquals("hello.jsp", modelAndView.getViewName());
    }

}</pre>

<p>Para ejecutar el test (y todos los tests que escribamos en el
futuro), basta con que seleccionemos <tt class="classname">'Run as &gt; JUnit Test'</tt>
 sobre el menú contextual que aparece cuando se pincha el botón derecho 
sobre la clase de test. Si el test se ejecuta de forma satisfactoria 
podrás ver una barra verde que lo indica.</p>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.9"></a>1.9.&nbsp;Crear
la <tt class="interfacename">Vista</tt></h2>
</div>
</div>
<div></div>
</div>

<p>Ahora es el momento de crear nuestra primera vista. Como hemos 
mencionado antes, estamos redirigiendo hacia una página JSP llamada <tt class="filename">'hello.jsp'</tt>. Para empezar, crearemos este fichero en el directorio <tt class="filename">'src/main/webapp'</tt>.</p>

<p><tt class="filename">'springapp/src/main/webapp/hello.jsp'</tt>:</p>
<pre class="programlisting">&lt;html&gt;
  &lt;head&gt;&lt;title&gt;Hello :: Spring Application&lt;/title&gt;&lt;/head&gt;
  &lt;body&gt;
    &lt;h1&gt;Hello - Spring Application&lt;/h1&gt;
    &lt;p&gt;Greetings.&lt;/p&gt;
  &lt;/body&gt;
&lt;/html&gt;</pre></div>

<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.10"></a>1.10.&nbsp;Compilar, desplegar y probar
la aplicación</h2>
</div>
</div>
<div></div>
</div>

<p>Para ejecutar la aplicación de nuevo, seleccionamos de nuevo <tt class="classname">'Run as &gt; Run on Server'</tt> sobre el menú contextual que aparece cuando se pincha el botón derecho sobre el nombre proyecto. <span class="emphasis"><em>(En algunos casos, es necasario reiniciar el servidor para asegurar que la aplicación se actualiza correctamente).</em></span></p>

<p>Probemos esta nueva versión de la aplicación. Desde el navegador que ofrece STS, o desde cualquier otro navegador, abrir la URL <a href="http://localhost:8080/springapp/hello.htm" target="_top">http://localhost:8080/springapp/hello.htm</a>. </p>

<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/screen2.png" align="middle">
<div class="caption">
<p>La aplicación actualizada</p>
</div>
</div>
</div>
</div>
<div class="section" lang="en">
<div class="titlepage">
<div>
<div>
<h2 class="title" style="clear: both;"><a name="step1.11"></a>1.11.&nbsp;Resumen</h2>
</div>
</div>
<div></div>
</div>

<p>Echemos un vistazo rápido a las partes de nuestra aplicacioón que hemos creado hasta ahora.</p>
<div class="orderedlist">
<ol type="1">
	<li>
	<p>Una página de inicio, <tt class="filename">'index.jsp'</tt>, la
	página de bienvenida de nuestra aplicación. Fue usada para comprobar
	que nuestra configuración era correcta. Más tarde la cambiaremos para
	proveer un enlance a nuestra aplicación.</p>
	</li>
	<li>
	<p>Un controlador frontal, <tt class="classname">DispatcherServlet</tt>,
	con el correspondiente archivo de configuración <tt class="filename">'app-config.xml'</tt>.</p>
	</li>
	<li>
	<p>Un controlador de página, <tt class="classname">HelloController</tt>,
	con funcionalidad limitada – simplemente devuelve un objeto <tt class="classname">ModelAndView</tt>. Actualmente tenemos un modelo vacío, más tarde proveeremos un modelo completo.</p>
	</li>
	<li>
	<p>Una unidad de test para la página del controlador, <tt class="classname">HelloControllerTests</tt>, para verificar que el
	nombre de la vista es el que esperamos.</p>
	</li>
	<li>
	<p>Una vista, <tt class="filename">'hello.jsp'</tt>, que de nuevo
	es extremadamente sencilla. Las buenas noticias son que el conjunto de
	la aplicación funciona y que estamos listos para añadir más
	funcionalidad.</p>
	</li>
</ol>
</div>
<p>A continuación puedes ver una captura de pantalla que muestra el aspecto que debería
tener la estructura de directorios del proyecto después de seguir todas las instrucciones anteriores.</p>


<div class="screenshot">
<div class="mediaobject" align="center"><img src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/dir-structure-endp1.png" align="middle">
<div class="caption">
<p>La estructura de directorios del proyecto al final de la parte 1</p>
</div>
</div>
</div>
</div>
</div>
<div xmlns="http://www.w3.org/TR/xhtml1/transitional" class="navfooter">
<hr>
<table summary="Navigation footer" width="100%">
	<tbody>
		<tr>
			<td width="40%" align="left"><a accesskey="p" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/overview.html">Anterior</a>&nbsp;</td>
			<td width="20%" align="center"><a accesskey="h" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/index.html">Inicio</a></td>
			<td width="40%" align="right">&nbsp;<a accesskey="n" href="http://www.uv.es/grimo/teaching/SpringMVCv4PasoAPaso/part2.html">Siguiente</a></td>
		</tr>
		<tr>
			<td valign="top" width="40%" align="left">Descripcion&nbsp;</td>
			<td width="20%" align="center"><span style="color: white; font-size: 90%;"><a href="http://www.uv.es/grimo">Autor: Francisco Grimaldo Moreno</a></span></td>
			<td valign="top" width="40%" align="right">&nbsp;Capítulo&nbsp;2.&nbsp;Desarrollando
			y Configurando la Vista y el Controlador</td>
		</tr>
	</tbody>
</table>
</div>

<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script><script src="Cap%C3%ADtulo%C2%A01.%C2%A0Aplicaci%C3%B3n%20Base%20y%20Configuraci%C3%B3n%20del%20Entorno%20Archivos/ga.js" type="text/javascript"></script>
<script type="text/javascript">
try {
var pageTracker = _gat._getTracker("UA-4959413-1");
pageTracker._trackPageview();
} catch(err) {}</script>


</div></div></div></body></html>